{% extends 'base.html' %}

{% block content %}
<div class="container">
    <h1 class="mb-4">Recent Activity</h1>

    <form method="get" class="mb-4">
        <div class="form-row">
            <div class="col">
                <select name="category" class="form-control">
                    <option value="">Filter by Category</option>
                    {% for category in categories %}
                    <option value="{{ category.id }}" {% if request.GET.category==category.id|stringformat:"s"
                        %}selected{% endif %}>
                        {{ category.name }}
                    </option>
                    {% endfor %}
                </select>
            </div>
            <div class="col">
                <select name="forum" class="form-control">
                    <option value="">Filter by Forum</option>
                    {% for forum in forums %}
                    <option value="{{ forum.id }}" {% if request.GET.forum==forum.id|stringformat:"s" %}selected{% endif
                        %}>
                        {{ forum.name }}
                    </option>
                    {% endfor %}
                </select>
            </div>
            <div class="col">
                <select name="tag" class="form-control">
                    <option value="">Filter by Tag</option>
                    {% for tag in tags %}
                    <option value="{{ tag.id }}" {% if request.GET.tag==tag.id|stringformat:"s" %}selected{% endif %}>
                        {{ tag.name }}
                    </option>
                    {% endfor %}
                </select>
            </div>
            <div class="col">
                <button type="submit" class="btn btn-primary">Filter</button>
            </div>
        </div>
    </form>

    <h2>Recent Threads</h2>
    <ul class="list-group mb-4">
        {% for thread in threads %}
        <li class="list-group-item">
            <a href="{% url 'thread_detail' thread.id %}">{{ thread.title }}</a>
            <small class="text-muted">Created {{ thread.created_at|date:"M d, Y H:i" }}</small>
        </li>
        {% empty %}
        <li class="list-group-item">No recent threads found.</li>
        {% endfor %}
    </ul>

    <h2>Recent Comments</h2>
    <ul class="list-group mb-4">
        {% for comment in comments %}
        <li class="list-group-item">
            <a href="{% url 'thread_detail' comment.thread.id %}#comment-{{ comment.id }}">{{
                comment.content|truncatewords:10 }}</a>
            <small class="text-muted">Posted {{ comment.created_at|date:"M d, Y H:i" }}</small>
        </li>
        {% empty %}
        <li class="list-group-item">No recent comments found.</li>
        {% endfor %}
    </ul>

    <h2>Recent Polls</h2>
    <ul class="list-group">
        {% for poll in polls %}
        <li class="list-group-item">
            <a href="{% url 'poll_detail' poll.id %}">{{ poll.question }}</a>
            <small class="text-muted">Created {{ poll.created_at|date:"M d, Y H:i" }}</small>
        </li>
        {% empty %}
        <li class="list-group-item">No recent polls found.</li>
        {% endfor %}
    </ul>
</div>
{% endblock %}